<html>
<head><title>YQL RSS Test</title>
  <script src="jquery-1.6.1.min.js"></script>            
</head>

<body>
<script>
var maxEntries = 5; // if 0 then there will be no limit
 
function slug(str){
 return str.replace(/\s/g,'-').replace(/[^a-zA-Z0-9\-]/g,'').toLowerCase();
}
/**
 * This function appends rss feed items to divs with the same slug
 * Name is the title of the feed, when slugged i use it as a div id
 * File is the rss feed
 */

function newFeed(name, file, format) {
    $.getJSON(
	      "http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20xml%20where%20url%3D%22"+encodeURIComponent(file)+"%22&format=json&callback=?",
	      function(data) {
		  var count = 0;
		  //grab ever rss item from the json result request
                  //$(data.query.results.rss.channel.item).each(function() {
                  $.each(data.query.results.rss.channel.item || data.query.results.item || data.query.results.entry,function(){
			  //if set up to be infinite or the limit is not reached, keep grabbing items
			  if(maxEntries == 0 || maxEntries>count){
			      var title = this.title;
			      var link = this.link;
			      var description = this.description;
			      var pubDate = this.pubDate;
			      // Format however you want, I only went for link and title
			      var anItem = "<a href='"+link+"' target='_blank'>"+title+"</a><br>";
			      //append to the div
			      $("#"+slug(name)).append(anItem);
			      count++;
			  }
		      });
	      });
}


$(document).ready(function() {
  //newFeed("gaga","http://dash.harvard.edu/open-search/?query=author_authority:c9e989d522c00c122594ca888fb74c44&sort_by=2&order=desc&rpp=5&format=rss");
  //newFeed("gaga","http://ehp03.niehs.nih.gov/article/feed");
  newFeed("gaga", "http://www.ehjournal.net/latest/rss");

});
  
</script>

<p>FHello, Reinhard. This is a test of using YQL to perform cross domain RSS retrieval.</p>

<div id="gaga"></div>



</body>
</html>
